# Milestone v1.0: MVP

**Status:** SHIPPED 2026-01-11
**Phases:** 1-4
**Total Plans:** 6

## Overview

Build a real-time MCP server that parses MTGA Player.log to expose live game state to Claude. Start with reliable log watching and parsing, build game state tracking, integrate external card/draft data, then wrap it all in FastMCP tools.

## Phases

### Phase 1: Foundation
**Goal:** Reliable log watching with event extraction from Player.log
**Depends on:** Nothing (first phase)
**Plans:** 2 plans

Plans:
- [x] 01-01: Python project structure with watchdog-based log watcher
- [x] 01-02: Multi-line JSON parser with event routing

**Key deliverables:**
- Watchdog-based log watcher handling Windows file locking
- Log parser accumulating multi-line JSON blocks
- Event routing for GreToClientEvent, MatchCreated, GameStateMessage
- Basic event callback system

### Phase 2: Game State
**Goal:** Complete game state snapshot from parsed events
**Depends on:** Phase 1
**Plans:** 1 plan

Plans:
- [x] 02-01: GameState class with zone/player/turn tracking

**Key deliverables:**
- GameState class with zones (battlefield, hand, graveyard, exile, library, stack)
- Card/permanent tracking with grpId mapping
- Turn/phase tracking (active player, priority, phase)
- Player state (life totals, mana pools)
- History tracking for opponent played cards

### Phase 3: External Data
**Goal:** Card oracle text and draft statistics from external sources
**Depends on:** Phase 2
**Plans:** 2 plans

Plans:
- [x] 03-01: Scryfall integration with bulk data download
- [x] 03-02: 17lands draft statistics with lazy loading

**Key deliverables:**
- Scryfall bulk data download and indexing by arena_id
- API fallback for cards not in bulk data
- 17lands JSON parsing for draft statistics (GIH WR, ALSA, IWD)
- Caching layer for performance

### Phase 4: MCP Server
**Goal:** FastMCP server exposing all functionality via STDIO
**Depends on:** Phase 3
**Plans:** 1 plan

Plans:
- [x] 04-01: FastMCP server with lifecycle management and tools

**Key deliverables:**
- get_game_state() tool with full board state serialization
- get_card_info(arena_id) tool for oracle text
- get_opponent_played_cards() tool
- get_draft_rating(card_name, set_code) tool
- Card serialization including oracle text (Calculator + Coach pattern)

---

## Milestone Summary

**Key Decisions:**
- STDIO transport over HTTP for lowest latency
- Tools over Resources for game state (MCP Resources don't support server-push)
- Calculator + Coach pattern (code tracks state, LLM explains)
- Scryfall bulk data with API fallback (rate limits make API-only impractical)
- Include oracle text in all serialization for LLM context
- Upsert pattern for GameStateMessage updates
- Lazy-load caches to avoid blocking server startup

**Issues Resolved:**
- Windows file locking handled via graceful retry
- Multi-line JSON accumulation with brace-depth tracking
- 17lands API returns JSON (not CSV as expected) - adapted

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

*For current project status, see .planning/ROADMAP.md*
